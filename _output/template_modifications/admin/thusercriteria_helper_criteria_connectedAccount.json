{
    "template": "helper_criteria",
    "description": "Add user criteria to connected account providers.",
    "execution_order": 10,
    "enabled": true,
    "action": "preg_replace",
    "find": "/<xf:options source=\"\\$data\\.connectedAccProviders\" \\/>\\s*<\\/xf:select>\\s*<\\/xf:option>/s",
    "replace": "$0\n<xf:set var=\"$fieldNameNotConAccs\" value=\"{$xf.options.thusercriteria_prefix}not_connected_accounts\" />\n<xf:option name=\"user_criteria[{$fieldNameNotConAccs}][rule]\" value=\"{$fieldNameNotConAccs}\" selected=\"{$criteria.{$fieldNameNotConAccs}}\"\n\t\t   label=\"{{ phrase('thusercriteria_user_is_connected_with_none_of_the_selected_connected_account_providers:') }}\">\n\n\t<xf:select name=\"user_criteria[{$fieldNameNotConAccs}][data][provider_ids]\" size=\"4\" multiple=\"true\" value=\"{$criteria.{$fieldNameNotConAccs}.provider_ids}\">\n\t\t<xf:options source=\"$data.connectedAccProviders\" />\n\t</xf:select>\n</xf:option>\n\n<xf:set var=\"$fieldNameNumConnectedAccounts\" value=\"{$xf.options.thusercriteria_prefix}num_connected_accounts\" />\n<xf:option name=\"user_criteria[{$fieldNameNumConnectedAccounts}][rule]\" value=\"{$fieldNameNumConnectedAccounts}\" selected=\"{$criteria.{$fieldNameNumConnectedAccounts}}\"\n\t\t   label=\"{{ phrase('th_user_criteria_user_has_at_least_x_connected_accounts:') }}\">\n\t<xf:numberbox name=\"user_criteria[{$fieldNameNumConnectedAccounts}][data][count]\" value=\"{$criteria.{$fieldNameNumConnectedAccounts}.count}\"\n\t\t\t\t  size=\"5\" min=\"0\" step=\"1\" />\n</xf:option>\n\n<xf:set var=\"$fieldNameNumMaxConnectedAccounts\" value=\"{$xf.options.thusercriteria_prefix}num_max_connected_accounts\" />\n<xf:option name=\"user_criteria[{$fieldNameNumMaxConnectedAccounts}][rule]\" value=\"{$fieldNameNumMaxConnectedAccounts}\" selected=\"{$criteria.{$fieldNameNumMaxConnectedAccounts}}\"\n\t\t   label=\"{{ phrase('th_user_criteria_user_has_no_more_than_x_connected_accounts:') }}\">\n\t<xf:numberbox name=\"user_criteria[{$fieldNameNumMaxConnectedAccounts}][data][count]\" value=\"{$criteria.{$fieldNameNumMaxConnectedAccounts}.count}\"\n\t\t\t\t  size=\"5\" min=\"0\" step=\"1\" />\n</xf:option>"
}